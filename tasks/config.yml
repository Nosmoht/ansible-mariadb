---
- name: Check if configuration file exists
  stat:
    path: '{{ mariadb_config_file }}'
  register: mariadb_config_file_stat

- name: Ensure configuration file
  file:
    name: '{{ mariadb_config_file }}'
    state: touch
    owner: root
    group: root
    mode: '0644'
  when: not mariadb_config_file_stat.stat.exists

- name: Ensure configuration
  ini_file:
    dest: '{{ mariadb_config_file }}'
    section: '{{ item.0.section }}'
    option: '{{ item.1.name }}'
    value: '{{ item.1.value }}'
  notify:
  - restart mariadb
  with_subelements:
  - mariadb_config
  - params
